<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>Información contacto empresa</title>
        <link rel="stylesheet" href="estilos.css">
        <script>
            window.onload = function () {
                    verificarSesion();
                };

                function verificarSesion() {
                    var usuario = sessionStorage.getItem('usuario');
                    if (!usuario) {
                        alert('Debe iniciar sesión primero');
                        window.location.href = 'login.html'; //Redirigir al login si no hay sesión
                    } else {
                        //Muestrar el nombre de usuario en la página
                        document.getElementById("bienvenido").textContent = "Bienvenido, " + usuario;
                    }
                }

                //Cerrar la sesión
                function cerrarSesion() {
                    sessionStorage.removeItem('usuario'); //Eliminar la sesión
                    window.location.href = 'login.html'; //Redirigir al login
                }


            function validarFormulario(){
                var id = document.getElementById("id").value;
                var nombre = document.getElementById("nombre").value;
                var cargo = document.getElementById("cargo").value;
                var departamento = document.getElementById("departamento").value;
                var email = document.getElementById("email").value;
                var telefono = document.getElementById("telefono").value;
                var extension = document.getElementById("extension").value;
                var direccion = document.getElementById("direccion").value;
                var horario = document.getElementById("horario").value;
                var acceso = document.getElementById("acceso").value;
                var relacion = document.getElementById("relacion").value;
                var fechaIngreso = document.getElementById("fechaIngreso").value;
                var foto = document.getElementById("foto").files[0];
                var observaciones = document.getElementById("observaciones").value;
                var sector = document.getElementById("sector").value;
                var notas = document.getElementById("notas").value;


                function validarRepresentante(nombre) {
                    let patron = /^[a-zA-ZáéíóúÁÉÍÓÚñÑüÜ\s]+$/;
                    if (!patron.test(nombre) || nombre.length > 50) {
                        alert("Nombre incorrecto");
                        return false;
                    }
                    return true;
                }

                function validarEmail(email) {
                    let patron = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!patron.test(email)) {
                        alert("El correo debe tener el formato: xx@xx.xx");
                        return false;
                    }
                    return true;
                }

                function validarTelefono(telefono) {
                    let patron = /^\(\+\d{1,3}\)\s\d{9}$/;
                    if (telefono && !patron.test(telefono)) {
                        alert("El teléfono debe tener el formato: (+xx) xxxxxxxxx");
                        return false;
                    }
                    return true;
                }

                if(validarEmail(email) && validarTelefono(telefono) && validarRepresentante(nombre)){
                    return true;
                }
            }
        </script>
    </head>


    <body>
        <header>
            <h2 id="bienvenido">...</h2>
            <button class="cerrar-sesion" onclick="cerrarSesion()">Cerrar sesión</button>
        </header>
        <h1>Información de contacto de la empresa</h1>
        <div id="formulario">
            <p>* son obligatorios</p>
            <form onsubmit="return validarFormulario();">
                Numero de identificacion de persona de contacto * <input type="number" id="id" placeholder="1234..."
                    required><br><br>
                Nombre completo * <input type="text" id="nombre" required><br><br>
                Cargo o puesto * <input type="text" id="cargo" required><br><br>
                Departamento *
                <select id="departamento" required>
                    <option value="" disabled selected> </option>
                    <option value="rrhh">Recursos humanos </option>
                    <option value="administrador">Administrador</option>
                    <option value="operaciones">Operaciones</option>
                </select><br><br>
                Correo electrónico * <input type="text" id="email" required><br><br>
                Numero de teléfono * <input type="text" id="telefono" placeholder="(+xx) xxxxxxxxx" required><br><br>
                Extensión telefónica <input type="number" id="extension"><br><br>
                Direccion <input type="text" id="direccion"><br><br>
                Horario de trabajo <input type="text" id="horario"><br><br>
                Nivel de acceso
                <select id="acceso">
                    <option value="" disabled selected> </option>
                    <option value="total">Total</option>
                    <option value="limitado">Limitado</option>
                </select><br><br>
                Relación con la empresa
                <select id="relacion">
                    <option value="" disabled selected> </option>
                    <option value="empleado">Empleado</option>
                    <option value="contratista">Contratista</option>
                    <option value="consultor">Consultor</option>
                    <option value="directivo">Directivo</option>
                </select><br><br>
                Fecha de ingreso a la empresa <input type="date" id="fechaIngreso"><br><br>
                Foto de perfil <input type="file" id="foto" accept=".png, .jpg"><br><br>
                Observaciones <textarea id="observaciones"></textarea><br><br>
                Estado de la persona de contacto
                <select id="sector">
                    <option value="" disabled selected> </option>
                    <option value="activo">Activo</option>
                    <option value="inactivo">Inactivo</option>
                    <option value="licencia">En licencia</option>
                    <option value="baja">Baja</option>
                </select><br><br>
                Notas adicionales <textarea id="notas"></textarea><br><br>

                <br><input type="submit" value="Añadir informacion">
            </form>
            <button id="volver" onclick="window.location.href='menuTutor.html'">Volver</button>
        </div>
    </body>
</html>